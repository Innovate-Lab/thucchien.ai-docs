<!doctype html>
<html lang="vn" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-user-guide/image-generation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Sinh hình ảnh (Image Generation) | AI Thực Chiến</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.thucchien.ai/img/thucchien-social-card.png"><meta data-rh="true" name="twitter:image" content="https://docs.thucchien.ai/img/thucchien-social-card.png"><meta data-rh="true" property="og:url" content="https://docs.thucchien.ai/docs/user-guide/image-generation"><meta data-rh="true" property="og:locale" content="vn"><meta data-rh="true" name="docusaurus_locale" content="vn"><meta data-rh="true" name="docsearch:language" content="vn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Sinh hình ảnh (Image Generation) | AI Thực Chiến"><meta data-rh="true" name="description" content="AI cung cấp hai phương pháp để tạo hình ảnh từ mô tả văn bản (prompt), tùy thuộc vào mô hình bạn sử dụng."><meta data-rh="true" property="og:description" content="AI cung cấp hai phương pháp để tạo hình ảnh từ mô tả văn bản (prompt), tùy thuộc vào mô hình bạn sử dụng."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.thucchien.ai/docs/user-guide/image-generation"><link data-rh="true" rel="alternate" href="https://docs.thucchien.ai/docs/user-guide/image-generation" hreflang="vn"><link data-rh="true" rel="alternate" href="https://docs.thucchien.ai/docs/user-guide/image-generation" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Hướng dẫn sử dụng API","item":"https://docs.thucchien.ai/docs/user-guide"},{"@type":"ListItem","position":2,"name":"Sinh hình ảnh (Image Generation)","item":"https://docs.thucchien.ai/docs/user-guide/image-generation"}]}</script><link rel="stylesheet" href="/assets/css/styles.48999c32.css">
<script src="/assets/js/runtime~main.d208c10e.js" defer="defer"></script>
<script src="/assets/js/main.a3231d7a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="/assets/images/generated_image_1-b93c006c743816a78cb63fbe2b0aba6c.png"><link rel="preload" as="image" href="/assets/images/generated_image_2-48daeedba94087e489d3636600babb06.png"><link rel="preload" as="image" href="/assets/images/generated_chat_image-c5f1e31235f6001fe94d737bf2b378ff.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="AI Thực Chiến Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="AI Thực Chiến Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AI Thực Chiến</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/user-guide">Tài liệu</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs/user-guide"><span title="Hướng dẫn sử dụng API" class="categoryLinkLabel_W154">Hướng dẫn sử dụng API</span></a><button aria-label="Collapse sidebar category &#x27;Hướng dẫn sử dụng API&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user-guide/introduction"><span title="Giới thiệu" class="linkLabel_WmDU">Giới thiệu</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user-guide/core-concepts"><span title="Các khái niệm cốt lõi" class="linkLabel_WmDU">Các khái niệm cốt lõi</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user-guide/text-generation"><span title="Sinh văn bản (Text Generation)" class="linkLabel_WmDU">Sinh văn bản (Text Generation)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/user-guide/image-generation"><span title="Sinh hình ảnh (Image Generation)" class="linkLabel_WmDU">Sinh hình ảnh (Image Generation)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user-guide/video-generation-veo3"><span title="Sinh video với Veo 3 (Quy trình bất đồng bộ)" class="linkLabel_WmDU">Sinh video với Veo 3 (Quy trình bất đồng bộ)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user-guide/text-to-speech"><span title="Chuyển văn bản thành giọng nói (Text-to-Speech)" class="linkLabel_WmDU">Chuyển văn bản thành giọng nói (Text-to-Speech)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user-guide/references"><span title="Tham khảo" class="linkLabel_WmDU">Tham khảo</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/vibe-coding"><span title="VibeCoding" class="categoryLinkLabel_W154">VibeCoding</span></a><button aria-label="Expand sidebar category &#x27;VibeCoding&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-item-post-parent"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/api-reference"><span title="Tham chiếu API" class="categoryLinkLabel_W154">Tham chiếu API</span></a><button aria-label="Expand sidebar category &#x27;Tham chiếu API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/tips-and-tricks-real-world"><span title="Tips và Tricks Thực Chiến" class="categoryLinkLabel_W154">Tips và Tricks Thực Chiến</span></a><button aria-label="Expand sidebar category &#x27;Tips và Tricks Thực Chiến&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/using-google-genai"><span title="Sử dụng với Google GenAI" class="categoryLinkLabel_W154">Sử dụng với Google GenAI</span></a><button aria-label="Expand sidebar category &#x27;Sử dụng với Google GenAI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/user-guide"><span>Hướng dẫn sử dụng API</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Sinh hình ảnh (Image Generation)</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Sinh hình ảnh (Image Generation)</h1></header>
<!-- -->
<p>AI cung cấp hai phương pháp để tạo hình ảnh từ mô tả văn bản (prompt), tùy thuộc vào mô hình bạn sử dụng.</p>
<ul>
<li><strong>Phương pháp chuẩn (Standard):</strong> Sử dụng endpoint <code>/images/generations</code>, tuân thủ theo API của OpenAI.</li>
<li><strong>Phương pháp trò chuyện (Chat):</strong> Sử dụng endpoint <code>/chat/completions</code> với các mô hình đa phương thức (multimodal).</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-phương-pháp-chuẩn-endpoint-imagesgenerations">1. Phương pháp chuẩn (Endpoint: <code>/images/generations</code>)<a href="#1-phương-pháp-chuẩn-endpoint-imagesgenerations" class="hash-link" aria-label="Direct link to 1-phương-pháp-chuẩn-endpoint-imagesgenerations" title="Direct link to 1-phương-pháp-chuẩn-endpoint-imagesgenerations" translate="no">​</a></h2>
<p>Phương pháp này tương thích với các thư viện client của OpenAI và là cách được khuyến nghị cho các mô hình sinh ảnh chuyên dụng. API sẽ trả về dữ liệu ảnh được mã hóa dưới dạng <strong>base64</strong> thay vì URL.</p>
<p><strong>Model được hỗ trợ:</strong></p>
<ul>
<li><a href="https://cloud.google.com/vertex-ai/generative-ai/docs/models/imagen/4-0-generate-001" target="_blank" rel="noopener noreferrer"><code>imagen-4</code></a> (Google Vertex AI)</li>
</ul>
<p><strong>Endpoint:</strong> <code>POST /images/generations</code></p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Chú ý</div><div class="admonitionContent_BuS1"><p>Một số mô hình có thể trả về URL thay vì dữ liệu base64. Trong trường hợp đó, bạn có thể sử dụng phương pháp trò chuyện bên dưới.
Ngoài ra để tránh lỗi caching, bạn có thể thêm một chuỗi ngẫu nhiên vào cuối prompt, ví dụ: <code>&quot;A beautiful landscape painting, &quot; + str(random.randint(1, 10000))</code>. hoặc thay đổi prompt một chút.</p></div></div>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">curl</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Python (requests)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Python (openai)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Python (litellm)</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Sử dụng <code>curl</code> để tạo nhiều hình ảnh và lưu chúng từ dữ liệu base64.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1D1E1E;--prism-background-color:#DEE4E9"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#1D1E1E;background-color:#DEE4E9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1D1E1E"><span class="token comment" style="color:#717374"># Cấu hình</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token assign-left variable" style="color:#1D1E1E">API_URL</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token string" style="color:#1675D1">&quot;https://api.thucchien.ai/v1/images/generations&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token assign-left variable" style="color:#1D1E1E">API_KEY</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token string" style="color:#1675D1">&quot;&lt;your_api_key&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token assign-left variable" style="color:#1D1E1E">PROMPT</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token string" style="color:#1675D1">&quot;Một bức tranh phong cảnh biển hoàng hôn, phong cách sơn dầu&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token assign-left variable" style="color:#1D1E1E">NUM_IMAGES</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token number" style="color:#4970A8">2</span><span class="token plain"> </span><span class="token comment" style="color:#717374"># Số lượng ảnh cần tạo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># Gọi API</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token assign-left variable" style="color:#1D1E1E">response</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token variable" style="color:#1D1E1E">$(</span><span class="token variable function" style="color:#50C2F6">curl</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable parameter variable" style="color:#1D1E1E">-s</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable parameter variable" style="color:#1D1E1E">--location</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&quot;</span><span class="token variable string variable" style="color:#1D1E1E">$API_URL</span><span class="token variable string" style="color:#1675D1">&quot;</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable punctuation" style="color:#A1A2A3">\</span><span class="token variable" style="color:#1D1E1E"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable" style="color:#1D1E1E"></span><span class="token variable parameter variable" style="color:#1D1E1E">--header</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&#x27;Content-Type: application/json&#x27;</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable punctuation" style="color:#A1A2A3">\</span><span class="token variable" style="color:#1D1E1E"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable" style="color:#1D1E1E"></span><span class="token variable parameter variable" style="color:#1D1E1E">--header</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&quot;Authorization: Bearer </span><span class="token variable string variable" style="color:#1D1E1E">$API_KEY</span><span class="token variable string" style="color:#1675D1">&quot;</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable punctuation" style="color:#A1A2A3">\</span><span class="token variable" style="color:#1D1E1E"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable" style="color:#1D1E1E"></span><span class="token variable parameter variable" style="color:#1D1E1E">--data</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&quot;{</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">  </span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string" style="color:#1675D1">model</span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string" style="color:#1675D1">: </span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string" style="color:#1675D1">imagen-4</span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string" style="color:#1675D1">,</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">  </span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string" style="color:#1675D1">prompt</span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string" style="color:#1675D1">: </span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string variable" style="color:#1D1E1E">$PROMPT</span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string" style="color:#1675D1">,</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">  </span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string" style="color:#1675D1">n</span><span class="token variable string entity" style="color:#1D1E1E">\&quot;</span><span class="token variable string" style="color:#1675D1">: </span><span class="token variable string variable" style="color:#1D1E1E">$NUM_IMAGES</span><span class="token variable string" style="color:#1675D1">,</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">}&quot;</span><span class="token variable" style="color:#1D1E1E">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># Xử lý và lưu từng ảnh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token assign-left variable" style="color:#1D1E1E">image_count</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token variable" style="color:#1D1E1E">$(</span><span class="token variable builtin class-name" style="color:#50C2F6">echo</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&quot;</span><span class="token variable string variable" style="color:#1D1E1E">$response</span><span class="token variable string" style="color:#1675D1">&quot;</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable operator" style="color:#1D1E1E">|</span><span class="token variable" style="color:#1D1E1E"> jq </span><span class="token variable string" style="color:#1675D1">&#x27;.data | length&#x27;</span><span class="token variable" style="color:#1D1E1E">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;</span><span class="token string variable" style="color:#1D1E1E">$image_count</span><span class="token string" style="color:#1675D1">&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#1D1E1E">-gt</span><span class="token plain"> </span><span class="token number" style="color:#4970A8">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">;</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">for</span><span class="token plain"> </span><span class="token variable punctuation" style="color:#A1A2A3">((</span><span class="token variable" style="color:#1D1E1E">i</span><span class="token variable operator" style="color:#1D1E1E">=</span><span class="token variable number" style="color:#4970A8">0</span><span class="token variable punctuation" style="color:#A1A2A3">;</span><span class="token variable" style="color:#1D1E1E"> i</span><span class="token variable operator" style="color:#1D1E1E">&lt;</span><span class="token variable" style="color:#1D1E1E">$image_count</span><span class="token variable punctuation" style="color:#A1A2A3">;</span><span class="token variable" style="color:#1D1E1E"> i</span><span class="token variable operator" style="color:#1D1E1E">++</span><span class="token variable punctuation" style="color:#A1A2A3">))</span><span class="token punctuation" style="color:#A1A2A3">;</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token assign-left variable" style="color:#1D1E1E">image_data</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token variable" style="color:#1D1E1E">$(</span><span class="token variable builtin class-name" style="color:#50C2F6">echo</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&quot;</span><span class="token variable string variable" style="color:#1D1E1E">$response</span><span class="token variable string" style="color:#1675D1">&quot;</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable operator" style="color:#1D1E1E">|</span><span class="token variable" style="color:#1D1E1E"> jq </span><span class="token variable parameter variable" style="color:#1D1E1E">-r</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&quot;.data[</span><span class="token variable string variable" style="color:#1D1E1E">$i</span><span class="token variable string" style="color:#1675D1">].b64_json&quot;</span><span class="token variable" style="color:#1D1E1E">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token comment" style="color:#717374"># Lưu file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token builtin class-name" style="color:#50C2F6">echo</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;</span><span class="token string variable" style="color:#1D1E1E">$image_data</span><span class="token string" style="color:#1675D1">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#1D1E1E">|</span><span class="token plain"> base64 </span><span class="token parameter variable" style="color:#1D1E1E">--decode</span><span class="token plain"> </span><span class="token operator" style="color:#1D1E1E">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;generated_image_</span><span class="token string variable" style="color:#1D1E1E">$((</span><span class="token string variable" style="color:#1D1E1E">i</span><span class="token string variable operator" style="color:#1D1E1E">+</span><span class="token string variable number" style="color:#4970A8">1</span><span class="token string variable" style="color:#1D1E1E">))</span><span class="token string" style="color:#1675D1">.png&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token builtin class-name" style="color:#50C2F6">echo</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;Image </span><span class="token string variable" style="color:#1D1E1E">$((</span><span class="token string variable" style="color:#1D1E1E">i</span><span class="token string variable operator" style="color:#1D1E1E">+</span><span class="token string variable number" style="color:#4970A8">1</span><span class="token string variable" style="color:#1D1E1E">))</span><span class="token string" style="color:#1675D1"> saved to generated_image_</span><span class="token string variable" style="color:#1D1E1E">$((</span><span class="token string variable" style="color:#1D1E1E">i</span><span class="token string variable operator" style="color:#1D1E1E">+</span><span class="token string variable number" style="color:#4970A8">1</span><span class="token string variable" style="color:#1D1E1E">))</span><span class="token string" style="color:#1675D1">.png&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token builtin class-name" style="color:#50C2F6">echo</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;Failed to generate images. Response:&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token builtin class-name" style="color:#50C2F6">echo</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;</span><span class="token string variable" style="color:#1D1E1E">$response</span><span class="token string" style="color:#1675D1">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">fi</span><br></span></code></pre></div></div><p><b>Ví dụ kết quả:</b></p><div style="display:flex;gap:10px"><img src="/assets/images/generated_image_1-b93c006c743816a78cb63fbe2b0aba6c.png" alt="Generated Image 1" style="width:49%"><img src="/assets/images/generated_image_2-48daeedba94087e489d3636600babb06.png" alt="Generated Image 2" style="width:49%"></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Sử dụng thư viện <code>requests</code> để giải mã và lưu nhiều hình ảnh.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1D1E1E;--prism-background-color:#DEE4E9"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#1D1E1E;background-color:#DEE4E9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1D1E1E"><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Cấu hình ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_BASE </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;https://api.thucchien.ai/v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_KEY </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;&lt;your_api_key&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Gọi API để tạo hình ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">url </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#1675D1">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">AI_API_BASE</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">/images/generations&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">headers </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token string" style="color:#1675D1">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;application/json&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token string" style="color:#1675D1">&quot;Authorization&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Bearer </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">AI_API_KEY</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token punctuation" style="color:#A1A2A3">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token string" style="color:#1675D1">&quot;model&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;imagen-4&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token string" style="color:#1675D1">&quot;prompt&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;A majestic white tiger walking through a snowy forest&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token string" style="color:#1675D1">&quot;n&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token number" style="color:#4970A8">2</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token comment" style="color:#717374"># Yêu cầu 2 ảnh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token punctuation" style="color:#A1A2A3">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">try</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  response </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> headers</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">headers</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> data</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">json</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  response</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">raise_for_status</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  result </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">json</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token comment" style="color:#717374"># --- Xử lý và lưu từng ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> image_obj </span><span class="token keyword" style="color:#1F53C0">in</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">enumerate</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&#x27;data&#x27;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      b64_data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> image_obj</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&#x27;b64_json&#x27;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      image_data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">b64_data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      save_path </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#1675D1">f&quot;generated_image_</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation operator" style="color:#1D1E1E">+</span><span class="token string-interpolation interpolation number" style="color:#4970A8">1</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">.png&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><span class="token keyword" style="color:#1F53C0">with</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">open</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">save_path</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&#x27;wb&#x27;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">          f</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Image saved to </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">save_path</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">except</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">exceptions</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">RequestException </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;An error occurred: </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Response body: </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">.</span><span class="token string-interpolation interpolation">text </span><span class="token string-interpolation interpolation keyword" style="color:#1F53C0">if</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#1675D1">&#x27;response&#x27;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#1F53C0">in</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation builtin" style="color:#1675D1">locals</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#1F53C0">else</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#1675D1">&#x27;No response&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1D1E1E;--prism-background-color:#DEE4E9"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#1D1E1E;background-color:#DEE4E9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1D1E1E"><span class="token keyword" style="color:#1F53C0">from</span><span class="token plain"> openai </span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> OpenAI</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Cấu hình ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_BASE </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;https://api.thucchien.ai/v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_KEY </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;&lt;your_api_key&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Khởi tạo client ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">client </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  api_key</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">AI_API_KEY</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  base_url</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">AI_API_BASE</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Gọi API để tạo hình ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">response </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">images</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">generate</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  model</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token string" style="color:#1675D1">&quot;imagen-4&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  prompt</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token string" style="color:#1675D1">&quot;An astronaut riding a horse on Mars, photorealistic&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  n</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token number" style="color:#4970A8">2</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token comment" style="color:#717374"># Yêu cầu 2 ảnh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Xử lý và lưu từng ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> image_obj </span><span class="token keyword" style="color:#1F53C0">in</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">enumerate</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  b64_data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> image_obj</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">b64_json</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  image_data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">b64_data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  save_path </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#1675D1">f&quot;generated_image_</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation operator" style="color:#1D1E1E">+</span><span class="token string-interpolation interpolation number" style="color:#4970A8">1</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">.png&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">with</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">open</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">save_path</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&#x27;wb&#x27;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      f</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Image saved to </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">save_path</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Sử dụng hàm <code>litellm.image_generation</code>.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1D1E1E;--prism-background-color:#DEE4E9"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#1D1E1E;background-color:#DEE4E9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1D1E1E"><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> litellm</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Cấu hình ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_BASE </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;https://api.thucchien.ai&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_KEY </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;your_api_key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Gọi API để tạo hình ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">response </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> litellm</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">image_generation</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  prompt</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token string" style="color:#1675D1">&quot;A peaceful Japanese garden with a koi pond and cherry blossoms 2&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  model</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token string" style="color:#1675D1">&quot;litellm_proxy/imagen-4&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  n</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token number" style="color:#4970A8">2</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  api_key</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">AI_API_KEY</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  api_base</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">AI_API_BASE</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Xử lý và lưu từng ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> image_obj </span><span class="token keyword" style="color:#1F53C0">in</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">enumerate</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  b64_data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> image_obj</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&#x27;b64_json&#x27;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  image_data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">b64_data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  save_path </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#1675D1">f&quot;generated_image_</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation operator" style="color:#1D1E1E">+</span><span class="token string-interpolation interpolation number" style="color:#4970A8">1</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">.png&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">with</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">open</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">save_path</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&#x27;wb&#x27;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      f</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Image saved to </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">save_path</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><br></span></code></pre></div></div></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-phương-pháp-trò-chuyện-endpoint-chatcompletions">2. Phương pháp trò chuyện (Endpoint: <code>/chat/completions</code>)<a href="#2-phương-pháp-trò-chuyện-endpoint-chatcompletions" class="hash-link" aria-label="Direct link to 2-phương-pháp-trò-chuyện-endpoint-chatcompletions" title="Direct link to 2-phương-pháp-trò-chuyện-endpoint-chatcompletions" translate="no">​</a></h2>
<p>Một số mô hình đa phương thức cho phép bạn tạo hình ảnh ngay trong một cuộc hội thoại. Thay vì trả về URL, các mô hình này sẽ trả về dữ liệu ảnh được mã hóa dưới dạng base64.</p>
<p><strong>Model được hỗ trợ:</strong></p>
<ul>
<li><code>gemini-2.5-flash-image-preview</code></li>
</ul>
<p><strong>Endpoint:</strong> <code>POST /chat/completions</code></p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">curl</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Python (requests)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Python (openai)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Python (litellm)</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Sử dụng <code>curl</code> để yêu cầu hình ảnh và lưu từ dữ liệu base64.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1D1E1E;--prism-background-color:#DEE4E9"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#1D1E1E;background-color:#DEE4E9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1D1E1E"><span class="token comment" style="color:#717374"># Bước 1: Gọi API và trích xuất dữ liệu ảnh base64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token assign-left variable" style="color:#1D1E1E">IMAGE_DATA</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token variable" style="color:#1D1E1E">$(</span><span class="token variable function" style="color:#50C2F6">curl</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable parameter variable" style="color:#1D1E1E">-s</span><span class="token variable" style="color:#1D1E1E"> https://api.thucchien.ai/v1/chat/completions </span><span class="token variable punctuation" style="color:#A1A2A3">\</span><span class="token variable" style="color:#1D1E1E"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable" style="color:#1D1E1E"></span><span class="token variable parameter variable" style="color:#1D1E1E">-H</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&quot;Content-Type: application/json&quot;</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable punctuation" style="color:#A1A2A3">\</span><span class="token variable" style="color:#1D1E1E"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable" style="color:#1D1E1E"></span><span class="token variable parameter variable" style="color:#1D1E1E">-H</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&quot;Authorization: Bearer &lt;your_api_key&gt;&quot;</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable punctuation" style="color:#A1A2A3">\</span><span class="token variable" style="color:#1D1E1E"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable" style="color:#1D1E1E"></span><span class="token variable parameter variable" style="color:#1D1E1E">-d</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&#x27;{</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">  &quot;model&quot;: &quot;gemini-2.5-flash-image-preview&quot;,</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">  &quot;messages&quot;: [</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">      {</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">          &quot;role&quot;: &quot;user&quot;,</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">          &quot;content&quot;: &quot;An olympic size swimming pool with crystal clear water and modern architecture. High resolution, photorealistic, 8k&quot;</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">      }</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">  ]</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token variable string" style="color:#1675D1">}&#x27;</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable operator" style="color:#1D1E1E">|</span><span class="token variable" style="color:#1D1E1E"> jq </span><span class="token variable parameter variable" style="color:#1D1E1E">-r</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&#x27;.choices[0].message.images[0].image_url.url&#x27;</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable operator" style="color:#1D1E1E">|</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable function" style="color:#50C2F6">sed</span><span class="token variable" style="color:#1D1E1E"> </span><span class="token variable string" style="color:#1675D1">&#x27;s/^data:image\/png;base64,//&#x27;</span><span class="token variable" style="color:#1D1E1E">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># Bước 2: Giải mã base64 và lưu thành file ảnh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token plain"> </span><span class="token parameter variable" style="color:#1D1E1E">-n</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;</span><span class="token string variable" style="color:#1D1E1E">$IMAGE_DATA</span><span class="token string" style="color:#1675D1">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">;</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token builtin class-name" style="color:#50C2F6">echo</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;</span><span class="token string variable" style="color:#1D1E1E">$IMAGE_DATA</span><span class="token string" style="color:#1675D1">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#1D1E1E">|</span><span class="token plain"> base64 </span><span class="token parameter variable" style="color:#1D1E1E">--decode</span><span class="token plain"> </span><span class="token operator" style="color:#1D1E1E">&gt;</span><span class="token plain"> generated_chat_image.png</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token builtin class-name" style="color:#50C2F6">echo</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;Image saved to generated_chat_image.png&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token builtin class-name" style="color:#50C2F6">echo</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;Failed to get image data.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">fi</span><br></span></code></pre></div></div><p><b>Ví dụ kết quả:</b></p><div style="display:flex;justify-content:center"><img src="/assets/images/generated_chat_image-c5f1e31235f6001fe94d737bf2b378ff.png" alt="Ví dụ hình ảnh được tạo ra" style="max-width:512px;width:100%"></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Sử dụng thư viện <code>requests</code> để giải mã và lưu ảnh.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1D1E1E;--prism-background-color:#DEE4E9"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#1D1E1E;background-color:#DEE4E9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1D1E1E"><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Cấu hình ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_BASE </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;https://api.thucchien.ai/v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_KEY </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;&lt;your_api_key&gt;&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#717374"># Thay bằng API key của bạn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">IMAGE_SAVE_PATH </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;generated_chat_image.png&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Bước 1: Gọi API để tạo hình ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">url </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#1675D1">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">AI_API_BASE</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">/chat/completions&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">headers </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token string" style="color:#1675D1">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;application/json&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token string" style="color:#1675D1">&quot;Authorization&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Bearer </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">AI_API_KEY</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token punctuation" style="color:#A1A2A3">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token string" style="color:#1675D1">&quot;model&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;gemini-2.5-flash-image-preview&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token string" style="color:#1675D1">&quot;messages&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><span class="token punctuation" style="color:#A1A2A3">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">          </span><span class="token string" style="color:#1675D1">&quot;role&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;user&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">          </span><span class="token string" style="color:#1675D1">&quot;content&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;A futuristic cityscape at sunset, with flying cars and neon lights. High resolution, photorealistic, 8k&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><span class="token punctuation" style="color:#A1A2A3">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token punctuation" style="color:#A1A2A3">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">try</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  response </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> headers</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">headers</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> data</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">json</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  response</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">raise_for_status</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  result </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">json</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token comment" style="color:#717374"># Trích xuất dữ liệu ảnh base64 từ response</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  base64_string </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&#x27;choices&#x27;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token number" style="color:#4970A8">0</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&#x27;message&#x27;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&#x27;images&#x27;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token number" style="color:#4970A8">0</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&#x27;image_url&#x27;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&#x27;url&#x27;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&quot;Image data received successfully.&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token comment" style="color:#717374"># --- Bước 2: Giải mã và lưu hình ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token comment" style="color:#717374"># Loại bỏ tiền tố &#x27;data:image/png;base64,&#x27; nếu có</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">if</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&#x27;,&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">in</span><span class="token plain"> base64_string</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      header</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> encoded </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64_string</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&#x27;,&#x27;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token number" style="color:#4970A8">1</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">else</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      encoded </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64_string</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  image_data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">encoded</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">with</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">open</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">IMAGE_SAVE_PATH</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&#x27;wb&#x27;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      f</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Image saved to </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">IMAGE_SAVE_PATH</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">except</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">exceptions</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">RequestException </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;An error occurred: </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Response body: </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">.</span><span class="token string-interpolation interpolation">text </span><span class="token string-interpolation interpolation keyword" style="color:#1F53C0">if</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#1675D1">&#x27;response&#x27;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#1F53C0">in</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation builtin" style="color:#1675D1">locals</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#1F53C0">else</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#1675D1">&#x27;No response&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">except</span><span class="token plain"> </span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">KeyError</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> IndexError</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Failed to parse image data from response: </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Response body: </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">.</span><span class="token string-interpolation interpolation">text </span><span class="token string-interpolation interpolation keyword" style="color:#1F53C0">if</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#1675D1">&#x27;response&#x27;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#1F53C0">in</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation builtin" style="color:#1675D1">locals</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#1F53C0">else</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#1675D1">&#x27;No response&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Sử dụng thư viện <code>openai</code> để yêu cầu hình ảnh và xử lý dữ liệu base64.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1D1E1E;--prism-background-color:#DEE4E9"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#1D1E1E;background-color:#DEE4E9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1D1E1E"><span class="token keyword" style="color:#1F53C0">from</span><span class="token plain"> openai </span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> OpenAI</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Cấu hình ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_BASE </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;https://api.thucchien.ai/v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_KEY </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;&lt;your_api_key&gt;&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#717374"># Thay bằng API key của bạn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">IMAGE_SAVE_PATH </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;generated_chat_image.png&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Khởi tạo client ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">client </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  api_key</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">AI_API_KEY</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  base_url</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">AI_API_BASE</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># --- Bước 1: Gọi API để tạo hình ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">try</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  response </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">chat</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">completions</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">create</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      model</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token string" style="color:#1675D1">&quot;gemini-2.5-flash-image-preview&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      messages</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">          </span><span class="token punctuation" style="color:#A1A2A3">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">              </span><span class="token string" style="color:#1675D1">&quot;role&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;user&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">              </span><span class="token string" style="color:#1675D1">&quot;content&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;A detailed illustration of a vintage steam train crossing a mountain bridge. High resolution, photorealistic, 8k&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">          </span><span class="token punctuation" style="color:#A1A2A3">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      modalities</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&quot;image&quot;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token plain">  </span><span class="token comment" style="color:#717374"># Chỉ định trả về dữ liệu ảnh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token comment" style="color:#717374"># Trích xuất dữ liệu ảnh base64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  base64_string </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token number" style="color:#4970A8">0</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">images</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token number" style="color:#4970A8">0</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&#x27;image_url&#x27;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&quot;url&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&quot;Image data received successfully.&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token comment" style="color:#717374"># --- Bước 2: Giải mã và lưu hình ảnh ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">if</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&#x27;,&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">in</span><span class="token plain"> base64_string</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      header</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> encoded </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64_string</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&#x27;,&#x27;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token number" style="color:#4970A8">1</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">else</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      encoded </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64_string</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  image_data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">encoded</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">with</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">open</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">IMAGE_SAVE_PATH</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&#x27;wb&#x27;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      f</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Image saved to </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">IMAGE_SAVE_PATH</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;An error occurred: </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Sử dụng hàm <code>litellm.completion</code> để tạo hình ảnh.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#1D1E1E;--prism-background-color:#DEE4E9"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#1D1E1E;background-color:#DEE4E9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#1D1E1E"><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> litellm</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">import</span><span class="token plain"> random</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">random_prompt_seed </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> random</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">randint</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token number" style="color:#4970A8">1</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token number" style="color:#4970A8">10000</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># Seed is used use to generate different images for the same prompt and avoiding caching issues</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_BASE </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;https://api.thucchien.ai/v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">AI_API_KEY </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;your_api_key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">IMAGE_SAVE_PATH </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;generated_chat_image.png&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># Configure Litellm to use AI API</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">litellm</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">api_base </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> AI_API_BASE</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># Use streaming with Gemini 2.5 Flash Image Preview model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">response </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> litellm</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">completion</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  model</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token string" style="color:#1675D1">&quot;litellm_proxy/gemini-2.5-flash-image-preview&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  messages</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><span class="token punctuation" style="color:#A1A2A3">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">          </span><span class="token string" style="color:#1675D1">&quot;role&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;user&quot;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">          </span><span class="token string" style="color:#1675D1">&quot;content&quot;</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&quot;Tạo ảnh 2 con mèo bên khung cửa sổ đang nhìn ra vườn hoa. &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#1D1E1E">+</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">str</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">random_prompt_seed</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">      </span><span class="token punctuation" style="color:#A1A2A3">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  api_key</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain">AI_API_KEY</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  modalities</span><span class="token operator" style="color:#1D1E1E">=</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token string" style="color:#1675D1">&quot;image&quot;</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token plain">  </span><span class="token comment" style="color:#717374"># Specify modalities to include image data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># Get the base64 image string from the response</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">base64_string </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token number" style="color:#4970A8">0</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">images</span><span class="token punctuation" style="color:#A1A2A3">[</span><span class="token number" style="color:#4970A8">0</span><span class="token punctuation" style="color:#A1A2A3">]</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&quot;image_url&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&quot;url&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&quot;Image data received successfully.&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token comment" style="color:#717374"># Decode and save the image ---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">if</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&#x27;,&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">in</span><span class="token plain"> base64_string</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  header</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> encoded </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64_string</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string" style="color:#1675D1">&#x27;,&#x27;</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token number" style="color:#4970A8">1</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">else</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  encoded </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64_string</span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">image_data </span><span class="token operator" style="color:#1D1E1E">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">encoded</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">with</span><span class="token plain"> </span><span class="token builtin" style="color:#1675D1">open</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">IMAGE_SAVE_PATH</span><span class="token punctuation" style="color:#A1A2A3">,</span><span class="token plain"> </span><span class="token string" style="color:#1675D1">&#x27;wb&#x27;</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"> </span><span class="token keyword" style="color:#1F53C0">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#A1A2A3">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  f</span><span class="token punctuation" style="color:#A1A2A3">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#A1A2A3">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain">  </span><br></span><span class="token-line" style="color:#1D1E1E"><span class="token plain"></span><span class="token keyword" style="color:#1F53C0">print</span><span class="token punctuation" style="color:#A1A2A3">(</span><span class="token string-interpolation string" style="color:#1675D1">f&quot;Image saved to </span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">{</span><span class="token string-interpolation interpolation">IMAGE_SAVE_PATH</span><span class="token string-interpolation interpolation punctuation" style="color:#A1A2A3">}</span><span class="token string-interpolation string" style="color:#1675D1">&quot;</span><span class="token punctuation" style="color:#A1A2A3">)</span><br></span></code></pre></div></div></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Ghi chú</div><div class="admonitionContent_BuS1"><p>Để biết thêm chi tiết, bạn có thể tham khảo tài liệu về sinh ảnh từ <a href="https://cloud.google.com/vertex-ai/docs/generative-ai/image/generate-images" target="_blank" rel="noopener noreferrer">Google Cloud Vertex AI</a> và các tham số sinh ảnh cho Google AI Studio qua <a href="https://docs.litellm.ai/docs/providers/google_ai_studio/image_gen#supported-parameters" target="_blank" rel="noopener noreferrer">LiteLLM</a>.</p></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/user-guide/text-generation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Sinh văn bản (Text Generation)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/user-guide/video-generation-veo3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Sinh video với Veo 3 (Quy trình bất đồng bộ)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-phương-pháp-chuẩn-endpoint-imagesgenerations" class="table-of-contents__link toc-highlight">1. Phương pháp chuẩn (Endpoint: <code>/images/generations</code>)</a></li><li><a href="#2-phương-pháp-trò-chuyện-endpoint-chatcompletions" class="table-of-contents__link toc-highlight">2. Phương pháp trò chuyện (Endpoint: <code>/chat/completions</code>)</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Tài liệu</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/user-guide/introduction">Giới thiệu</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/user-guide/core-concepts">Hướng dẫn sử dụng</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/vibe-coding/introduction">VibeCoding</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Liên kết</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://thucchien.ai" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thông tin AI Thực Chiến<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://thucchien.ai/the-le-cuoc-thi/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thể lệ cuộc thi<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://thucchien.ai/#registration" target="_blank" rel="noopener noreferrer" class="footer__link-item">Đăng ký dự thi<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Tài liệu AI Thực Chiến.</div></div></div></footer></div>
</body>
</html>